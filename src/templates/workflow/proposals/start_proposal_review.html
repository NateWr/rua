{% extends "base.html" %}
{% load static from staticfiles %}
{% load bootstrap3 %}

{% block title %}Book Proposals{% endblock %}

{% block breadcrumbs %}
    <ol class="breadcrumb">
	  <li><a href="{% url 'user_home' %}">User Home</a></li>
	  <li class="">Workflow</li>
    <li class="active">Proposals</li>
	</ol>
{% endblock %}

{% block body %}
<div class="col-md-12">
  <form method="POST">
  {% csrf_token %}
  <h3>Start Proposal Review - {{ proposal.title }}</h3>
  <hr />
  <p>Select some reviewrs and a review form to start the review process.</p>
  <h4>Individual Review</h4>
  <p class="small">You can assign an individual reviewer. The reviewer will be asked to comment and make a recommendation.</p>
  <hr />
  <table class="table table-bordered small" cellspacing="0" width="100%" id='indv-reviewer'>
    <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Select</th>
    </tr>
    </thead>
    {% for reviewer in reviewers %}
    <tr>
      <td>{{ reviewer.first_name }}</td>
      <td>{{ reviewer.last_name }}</td>
      <td>{{ reviewer.email }}</td>
      <td><input type="checkbox" name="reviewer" value="{{ reviewer.id }}"/></td>
    </tr>
    {% endfor %}
  </table>
  <hr />
  <h4>Committee Review</h4>
  <p class="small">You can assign a committee to review your submission. The committee will each be asked to comment and vote on a recommended decision.</p>
  <table class="table table-bordered small" cellspacing="0" width="100%" id='comm-reviewer'>
    <thead>
    <tr>
      <th>Committee Name</th>
      <th>Number of Members</th>
      <th>Select</th>
    </tr>
    </thead>
    {% for committee in committees %}
    <tr>
      <td>{{ committee.name }}</td>
      <td>{{ committee.groupmembership_set.all.count }}</td>
      <td><input type="checkbox" name="committee" value="{{ committee.id }}"/></td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="3">No committess established. <a href="{% url 'manager_group_add' %}">Add one.</a></td>
    </tr>
    {% endfor %}
  </table>
  {% bootstrap_form start_form %}
  <button class="btn btn-success" type="submit">Submit</button>
  </form>
</div>
{% endblock %}

{% block js %}
{{ block.super }}
<script type="text/javascript" language="javascript" src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" language="javascript" src="//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
<script>  
  {% if reviewers %}
  $(document).ready(function() {
      $('#indv-reviewer').DataTable({
        "lengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]]
      });
  } );
  {% endif %}

  {% if committees %}
  $(document).ready(function() {
      $('#comm-reviewer').DataTable({
        "lengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]]
      });
  } );
  {% endif %}

$(document).ready(function() {
      $('#due_date').datepicker({ dateFormat: 'yy-mm-dd' }).val();
  });
</script>


{% endblock js %}